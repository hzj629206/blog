<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='ä»‹ç» Oracle Cloud å…è´¹å¯¹è±¡å­˜å‚¨çš„ä½¿ç”¨ï¼Œä»¥åŠä½¿ç”¨ Cloudflare Workers åš CDN åŠ é€Ÿã€‚'><meta name=keywords content="Object Storage,OCI,Oracle Cloud Infrastructure,Self-Hosted,Free Quota,Cloudflare,CDN"><title>Oracle å…è´¹å¯¹è±¡å­˜å‚¨ä½¿ç”¨ Cloudflare åš CDN</title>
<link rel=canonical href=https://ogr.xyz/p/oracle-object-storage/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property='og:title' content='Oracle å…è´¹å¯¹è±¡å­˜å‚¨ä½¿ç”¨ Cloudflare åš CDN'><meta property='og:description' content='ä»‹ç» Oracle Cloud å…è´¹å¯¹è±¡å­˜å‚¨çš„ä½¿ç”¨ï¼Œä»¥åŠä½¿ç”¨ Cloudflare Workers åš CDN åŠ é€Ÿã€‚'><meta property='og:url' content='https://ogr.xyz/p/oracle-object-storage/'><meta property='og:site_name' content='å¹³å‡¡çš„è·¯'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='OCI'><meta property='article:tag' content='Object Storage'><meta property='article:tag' content='Cloudflare'><meta property='article:tag' content='CDN'><meta property='article:published_time' content='2024-03-15T20:47:04+08:00'><meta property='article:modified_time' content='2024-03-15T20:47:04+08:00'><meta name=twitter:title content="Oracle å…è´¹å¯¹è±¡å­˜å‚¨ä½¿ç”¨ Cloudflare åš CDN"><meta name=twitter:description content="ä»‹ç» Oracle Cloud å…è´¹å¯¹è±¡å­˜å‚¨çš„ä½¿ç”¨ï¼Œä»¥åŠä½¿ç”¨ Cloudflare Workers åš CDN åŠ é€Ÿã€‚"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu54e4477c009483f2a745092446432d68_338159_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>å¹³å‡¡çš„è·¯</a></h1><h2 class=site-description>ä¸ªäººåšå®¢ï¼Œæ¬¢è¿äº¤æµ</h2></div></header><ol class=social-menu><li><a href=https://github.com/hzj629206 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>é“¾æ¥</span></a></li></ol><div class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></div></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#åˆ›å»ºå­˜å‚¨æ¡¶>åˆ›å»ºå­˜å‚¨æ¡¶</a></li><li><a href=#åˆ›å»ºè®¿é—®å¯†é’¥>åˆ›å»ºè®¿é—®å¯†é’¥</a></li><li><a href=#åˆ›å»ºé¢„å…ˆéªŒè¯çš„è¯·æ±‚>åˆ›å»ºé¢„å…ˆéªŒè¯çš„è¯·æ±‚</a></li><li><a href=#cloudflare-workers>Cloudflare Workers</a><ol><li><a href=#æ·»åŠ äºŒçº§åŸŸå>æ·»åŠ äºŒçº§åŸŸå</a></li><li><a href=#åˆ›å»º-worker>åˆ›å»º Worker</a></li><li><a href=#å°†äºŒçº§åŸŸåæŒ‡å‘-worker>å°†äºŒçº§åŸŸåæŒ‡å‘ Worker</a></li><li><a href=#å¼€å¯ç¼“å­˜>å¼€å¯ç¼“å­˜</a></li></ol></li><li><a href=#ä½¿ç”¨æ–¹æ³•>ä½¿ç”¨æ–¹æ³•</a></li><li><a href=#æ€»ç»“>æ€»ç»“</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/>å¯¹è±¡å­˜å‚¨</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/oracle-object-storage/>Oracle å…è´¹å¯¹è±¡å­˜å‚¨ä½¿ç”¨ Cloudflare åš CDN</a></h2><h3 class=article-subtitle>ä»‹ç» Oracle Cloud å…è´¹å¯¹è±¡å­˜å‚¨çš„ä½¿ç”¨ï¼Œä»¥åŠä½¿ç”¨ Cloudflare Workers åš CDN åŠ é€Ÿã€‚</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2024-03-15</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 6 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=èƒŒæ™¯>èƒŒæ™¯</h2><p>ä¸Šç¯‡åšæ–‡ã€Š<a class=link href=https://ogr.xyz/p/garage-setup/>Garageå¯¹è±¡å­˜å‚¨çš„å®‰è£…å’Œä½¿ç”¨</a>ã€‹ä»‹ç»äº†åœ¨ Oracle Cloud çš„å…è´¹å®ä¾‹ä¸Šç”¨ Garage æ­å»º S3 å…¼å®¹çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚</p><p>å®é™…ä¸Š Oracle Cloud çš„å…è´¹å¥—é¤é‡Œé¢è¿˜æœ‰ 20GB çš„ S3 å…¼å®¹çš„å¯¹è±¡å­˜å‚¨é¢åº¦ã€‚æœ¬ç€ä¸ç”¨ç™½ä¸ç”¨çš„ç²¾ç¥ï¼Œæ¥çœ‹çœ‹æ€ä¹ˆåˆ©ç”¨èµ·æ¥ã€‚<br>æœ¬åšå®¢å°±æ˜¯æ‰˜ç®¡äº Cloudflare Pagesï¼Œå›¾åºŠä½¿ç”¨ Oracle å¯¹è±¡å­˜å‚¨å¹¶ä½¿ç”¨ Cloudflare Workers åš CDN åŠ é€Ÿã€‚</p><p>ç›¸æ¯”è¾ƒç”¨å¼€æºé¡¹ç›®è‡ªè¡Œæ­å»ºçš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œäº‘å‚å•†çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸€èˆ¬åŠŸèƒ½æ›´å¤šã€‚OCI Object Storage çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å¯ä»¥è¿›è¡Œé¢„æˆæƒï¼Œåœ¨å­˜å‚¨æ¡¶è®¾ä¸ºç§æœ‰çš„æƒ…å†µä¸‹ï¼ŒWeb åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°é€šè¿‡æˆæƒç è¿›è¡Œè®¿é—®ã€‚<br>ï¼ˆæ²¡æœ‰æµ‹è¯•è¿‡æ˜¯å¦æ”¯æŒ S3 å…¼å®¹çš„è®¿é—®ç­–ç•¥ï¼Œå¦‚æœå…¼å®¹çš„è¯ï¼Œä¹Ÿå¯ä»¥ç”¨è®¿é—®ç­–ç•¥å®ç°å…è®¸åŒ¿åä»¥åªè¯»çš„å½¢å¼è®¿é—®ã€‚ï¼‰</p><h2 id=åˆ›å»ºå­˜å‚¨æ¡¶>åˆ›å»ºå­˜å‚¨æ¡¶</h2><p>è¿›å…¥<a class=link href=https://cloud.oracle.com/object-storage/buckets target=_blank rel=noopener>å­˜å‚¨æ¡¶</a>ç®¡ç†é¡µé¢ã€‚å¯¹äºå…è´¹å¥—é¤ç”¨æˆ·ï¼Œå¯ä»¥çœ‹åˆ°æç¤ºæœ‰ 20GB çš„å…è´¹å­˜å‚¨ç©ºé—´é¢åº¦ã€‚<img src=https://oos.ogr.xyz/e174a208096cb3c1b09fa57a9f67fd6b84318641af539e6cc9469fee52f5a9d0.png loading=lazy alt="picture 0"></p><p>ç‚¹å‡»<strong>åˆ›å»ºå­˜å‚¨æ¡¶</strong>æŒ‰é’®ï¼Œè¾“å…¥<strong>å­˜å‚¨æ¡¶åç§°</strong>ï¼Œå…¶å®ƒé€‰é¡¹ç”¨é»˜è®¤å³å¯ã€‚æˆ‘è¿™é‡Œçš„åç§°ä¸º <code>bucket-oracle-free-20G</code>ã€‚<img src=https://oos.ogr.xyz/d00c32aa10da678181f3b927692908b81af9aca3ad83bedd10a5cdcd982e13b8.png loading=lazy alt="picture 1"></p><p>æ­¤æ—¶è¯¥å­˜å‚¨æ¡¶è¿˜ä¸èƒ½è¢«è®¿é—®ã€‚æ³¨æ„<strong>å¯è§æ€§</strong>è®¾ç½®ï¼Œå¦‚æœè®¾ç½®ä¸º<strong>å…¬å…±</strong>ï¼Œé‚£ä¹ˆå°†å…è®¸åŒ¿åç”¨æˆ·å’Œæœªé€šè¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®è¯¥å­˜å‚¨æ¡¶ä¸­å­˜å‚¨çš„æ•°æ®ï¼Œè¿™æ ·æ˜¯ä¸å®‰å…¨çš„ã€‚å»ºè®®ä¿æŒ<strong>ä¸“ç”¨</strong>ï¼Œä¸‹é¢ä¼šä»‹ç»é€šè¿‡ Cloudflare å…è´¹ CDN è®¿é—®ä¸“ç”¨å­˜å‚¨æ¡¶çš„èµ„æºã€‚</p><h2 id=åˆ›å»ºè®¿é—®å¯†é’¥>åˆ›å»ºè®¿é—®å¯†é’¥</h2><p>ä»é¡¶éƒ¨å¯¼èˆªæ çš„è¿›å…¥<strong>æˆ‘çš„æ¦‚è¦ä¿¡æ¯</strong>ã€‚<br><img src=https://oos.ogr.xyz/673c4788f1bd29a95f53acef1b21eb6211b26c6af98d87635df0892c9a8da343.png loading=lazy width=50%></p><p>ä»å·¦è¾¹çš„ä¾§è¾¹æ è¿›å…¥<strong>å®¢æˆ·å¯†é’¥</strong>ã€‚<br><img src=https://oos.ogr.xyz/2a07ce17687bccbff8b55a5e0bc54445f315bdb592a62a3fd3d823d9d21e44ca.png loading=lazy width=50%></p><p>ç‚¹å‡»<strong>ç”Ÿæˆå¯†é’¥</strong>å¹¶è¾“å…¥å¯†é’¥åç§°ï¼Œå°†ç”Ÿæˆå¯†é’¥ (<code>Secret key</code>)ï¼Œè¿™ä¸ªåªæœ‰åœ¨åˆ›å»ºæ—¶èƒ½å±•ç¤ºæ˜æ–‡ï¼Œéœ€è¦å¦å¤–ä¿å­˜ä¸‹æ¥ã€‚<br><img src=https://oos.ogr.xyz/97e021df71930de8eac8c88e23e1e63b4a820bca5ba6da61339d1fd5cb8bcbbb.png loading=lazy width=50%></p><p>å›åˆ°å¯†é’¥åˆ—è¡¨ï¼Œå¯ä»¥çœ‹åˆ°åˆ›å»ºçš„å¯†é’¥ï¼Œå…¶ä¸­<strong>è®¿é—®å¯†é’¥</strong>æ˜¯ <code>Key ID</code>ï¼Œå¯ä»¥å¤åˆ¶æ˜æ–‡ã€‚</p><p>è‡³æ­¤å¯ä»¥ä½¿ç”¨å„ç§ S3 å…¼å®¹çš„å®¢æˆ·ç«¯å’Œåº“è®¿é—®å­˜å‚¨æ¡¶äº†ã€‚éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p><ol><li><code>region</code> æ˜¯å½“å‰åŒºåŸŸï¼Œä¸€èˆ¬åœ¨ç½‘å€é‡Œé¢ä¼šæœ‰ç±»ä¼¼äº <code>region=ap-tokyo-1</code> çš„å‚æ•°ã€‚</li><li><code>bucket</code> å¹¶ä¸æ˜¯ä¸Šé¢åˆ›å»ºå­˜å‚¨æ¡¶æ—¶æŒ‡å®šçš„åç§°ï¼Œè€Œæ˜¯å­˜å‚¨æ¡¶è¯¦æƒ…é¡µé¢çš„<strong>åç§°ç©ºé—´</strong>ã€‚</li><li><code>endpoint</code> å‚è€ƒ <a class=link href=https://docs.oracle.com/en-us/iaas/Content/Object/Concepts/dedicatedendpoints.htm target=_blank rel=noopener>OCI Object Storage Dedicated Endpoints</a>ï¼Œéœ€è¦åœ¨åŸŸåååŠ ä¸Šå­˜å‚¨æ¡¶åç§°ã€‚ç¤ºä¾‹ï¼š<code>https://compat.objectstorage.ap-tokyo-1.oraclecloud.com/bucket-oracle-free-20G</code>ã€‚</li><li>S3 å®¢æˆ·ç«¯å¾—åˆ°çš„ URL ä¸º <code>https://&lt;namespace>.compat.objectstorage.ap-tokyo-1.oraclecloud.com/bucket-oracle-free-20G/&lt;key></code>ã€‚</li></ol><h2 id=åˆ›å»ºé¢„å…ˆéªŒè¯çš„è¯·æ±‚>åˆ›å»ºé¢„å…ˆéªŒè¯çš„è¯·æ±‚</h2><p>ä¸Šé¢å·²ç»èƒ½ç”¨ <code>Key ID</code> å’Œ <code>Secret key</code> è®¿é—®å­˜å‚¨æ¡¶å¯¹è±¡äº†ã€‚å¯¹é€šè¿‡ Web åº”ç”¨è®¿é—®å­˜å‚¨æ¡¶çš„åœºæ™¯æœ‰æ›´ç®€å•çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯åˆ›å»º<strong>é¢„å…ˆéªŒè¯çš„è¯·æ±‚</strong>ã€‚é¢„å…ˆéªŒè¯çš„è¯·æ±‚å…è®¸è®¿é—®å­˜å‚¨æ¡¶å¯¹è±¡è€Œä¸éœ€è¦æä¾›è®¿é—®å¯†é’¥ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯é¢„å…ˆç”Ÿæˆè®¿é—®æˆæƒç ã€‚åœ¨ä½¿ç”¨ Cloudflare Workers å®ç° CDN æ—¶ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚</p><p>è¿›å…¥å­˜å‚¨æ¡¶è¯¦æƒ…é¡µé¢ï¼Œä»å·¦è¾¹çš„ä¾§è¾¹æ è¿›å…¥<strong>é¢„å…ˆéªŒè¯çš„è¯·æ±‚</strong>ã€‚<img src=https://oos.ogr.xyz/9b12daf3c96c5a542d642e689e3cceb6e1fcb02ac5419f0a38245a607315b47c.png loading=lazy width=50%></p><p>ç‚¹å‡»åˆ›å»ºé¢„å…ˆéªŒè¯çš„è¯·æ±‚ã€‚å› ä¸ºæ˜¯ç”¨äº Cloudflare Workersï¼Œæˆ‘è¿™é‡Œèµ·åä¸º <code>Cloudflare-Workers</code>ã€‚ç›®æ ‡é€‰æ‹©<strong>å­˜å‚¨æ¡¶</strong>ï¼Œç±»å‹é€‰æ‹©<strong>å…è®¸å¯¹è±¡è¯»å–</strong>ï¼Œåˆ°æœŸæ—¶é—´å¯ä»¥æŒ‡å®šä¸€ä¸ªéå¸¸ä¹…è¿œçš„æ—¶é—´ä»¥è¿‘ä¼¼å®ç°æ°¸ä¸è¿‡æœŸã€‚<img src=https://oos.ogr.xyz/47130c42b6172097fb100f7c18d88438414f08bd301de34c3ea1f29212893f0d.png loading=lazy alt="picture 6"><br>ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªé¢„å…ˆéªŒè¯çš„è¯·æ±‚ URLï¼Œæˆæƒç å°±åŒ…å«åœ¨ URL é‡Œé¢ï¼Œè¿™ä¸ª URL åªæœ‰åœ¨åˆ›å»ºæ—¶èƒ½å±•ç¤ºæ˜æ–‡ï¼Œéœ€è¦å¦å¤–ä¿å­˜ä¸‹æ¥ã€‚</p><h2 id=cloudflare-workers>Cloudflare Workers</h2><p>Cloudflare ä¸ºæ™®é€šç”¨æˆ·æä¾›å…è´¹ CDN æœåŠ¡ï¼Œéå¸¸è‰¯å¿ƒã€‚<br>åŸºæœ¬ä¸Šè¦ä½¿ç”¨ Cloudflare æœåŠ¡ï¼Œéœ€è¦åœ¨ Cloudflare æ‰˜ç®¡åŸŸåã€‚å¦‚ä½•è´­ä¹°å’Œæ‰˜ç®¡åŸŸåå‚è§ç½‘ä¸Šå…¶å®ƒæ–‡ç« ã€‚æœ¬åšå®¢æ‰€ä½¿ç”¨çš„åŸŸå <code>ogr.xyz</code> å°±æ‰˜ç®¡äº Cloudflareã€‚</p><p>å¸¸è§„çš„ CDN æ¨¡å¼æ˜¯ï¼š<code>ç”¨æˆ· -> Cloudflare æœåŠ¡å™¨ -> Source æœåŠ¡å™¨</code>ã€‚è¿™ç§æ–¹å¼åªéœ€è¦åœ¨ Cloudflare æ‰˜ç®¡åŸŸåï¼Œä½¿ç”¨ CNAME å¹¶å¼€å¯ä»£ç†ï¼ˆå°äº‘æœµï¼‰å³å¯ã€‚
ç„¶è€Œå¯¹äº Oracle å¯¹è±¡å­˜å‚¨ï¼Œæ— è®ºå¯è§æ€§æ˜¯å…¬å…±è¿˜æ˜¯ä¸“ç”¨ï¼Œéƒ½æ— æ³•å®ç°ä»£ç†ã€‚è¿™æ˜¯å› ä¸º Oracle å¯¹è±¡å­˜å‚¨çš„åŸŸåé‡Œé¢åŒ…å«å­˜å‚¨æ¡¶çš„ <code>bucket</code> å’Œ <code>region</code> ä¿¡æ¯ï¼ŒCloudflare è®¿é—®æºæœåŠ¡å™¨æ—¶å¹¶ä¸ä¼šä½¿ç”¨æºæœåŠ¡å™¨åŸŸåï¼Œè€Œæ˜¯ä½¿ç”¨ Cloudflare æ‰˜ç®¡çš„åŸŸåï¼Œè¿™æ ·ä¸€æ¥ Oracle æœåŠ¡å™¨å°±ä¸èƒ½æ­£å¸¸å¤„ç†è¯·æ±‚äº†ã€‚ï¼ˆä¼ä¸šç‰ˆè®¢é˜…ç”¨æˆ·å¯ä»¥é€šè¿‡è§„åˆ™é‡å†™ <code>Host</code> HTTP Headerã€‚Cloudflare è§£é‡Šè¯´æ™®é€šç”¨æˆ·ä¸å…è®¸æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ã€‚ï¼‰<br>é‚£å°±åªèƒ½ä½¿ç”¨ Cloudflare Workers + Cache å®ç° CDN æ•ˆæœäº†ã€‚</p><h3 id=æ·»åŠ äºŒçº§åŸŸå>æ·»åŠ äºŒçº§åŸŸå</h3><p>è¿›å…¥åˆ°åŸŸåç®¡ç†é¡µé¢ï¼ŒHome -> Websites -> ogr.xyz -> DNS -> Recordsã€‚</p><p>æ·»åŠ äºŒçº§åŸŸåï¼Œç±»å‹ä¸º <code>CNAME</code>ï¼Œåå­—ä¸º <code>oss</code>ï¼Œç›®æ ‡ä¸º <code>&lt;namespace>.compat.objectstorage.&lt;region>.oraclecloud.com</code>ï¼Œé»˜è®¤å¼€å¯ä»£ç†ã€‚ä¹‹å <code>oss.ogr.xyz</code> çš„æµé‡ä¼šæ¥å…¥åˆ° Cloudflareã€‚<br>æ³¨æ„ï¼šè¿™é‡Œçš„ç›®æ ‡æ²¡æœ‰å®é™…ä½œç”¨ï¼Œåç»­ä¼šæŠŠæµé‡æŒ‡å‘ Workerã€‚</p><h3 id=åˆ›å»º-worker>åˆ›å»º Worker</h3><p>è¿›å…¥åˆ° Worker åˆ›å»ºé¡µé¢ï¼ŒHome -> Workers & Pagesã€‚</p><p>ç‚¹å‡» Create application -> Create Workerï¼Œè¾“å…¥ Worker åå­—ï¼Œæˆ‘è¿™é‡Œç”¨è·ŸåŸŸåç›¸åŒçš„åå­— <code>oss</code>ã€‚</p><p>è¿›å…¥åˆ°åˆ›å»ºçš„ Worker ç®¡ç†é¡µé¢ï¼Œç‚¹å‡» Edit Code è¿›å…¥åœ¨çº¿ç¼–è¾‘å™¨ï¼Œç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢ã€‚éœ€è¦ä¿®æ”¹ <code>OOS_BUCKET_PREAUTH_URL</code> ä¸ºä½ ä¸ºå­˜å‚¨æ¡¶åˆ›å»ºçš„<strong>é¢„å…ˆéªŒè¯çš„è¯·æ±‚ URL</strong>ã€‚ä¸ºé˜²æ­¢ä¸Šä¼ æ–‡ä»¶æ—¶æœªæŒ‡å®š <code>Content-Type</code>ï¼Œè¿™æ®µä»£ç ä½¿ç”¨æ–‡ä»¶æ‰©å±•åè¿›è¡Œæ˜ å°„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>FileMimeType</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/x-mpeg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mpega&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/3gpp&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;3gpp&#39;</span><span class=p>,</span> <span class=s1>&#39;3gp&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/postscript&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ps&#39;</span><span class=p>,</span> <span class=s1>&#39;eps&#39;</span><span class=p>,</span> <span class=s1>&#39;ai&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/x-aiff&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;aiff&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-aim&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;aim&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-jg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;art&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/x-ms-asf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;asx&#39;</span><span class=p>,</span> <span class=s1>&#39;asf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/basic&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ulw&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/x-msvideo&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;avi&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/x-rad-screenplay&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;avx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-bcpio&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;bcpio&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/bmp&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;dib&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/html&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;html&#39;</span><span class=p>,</span> <span class=s1>&#39;htm&#39;</span><span class=p>,</span> <span class=s1>&#39;shtml&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-cdf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;cdf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/pkix-cert&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;cer&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/java&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;class&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-cpio&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;cpio&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-csh&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;csh&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/css&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;css&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/msword&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;doc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/xml-dtd&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;dtd&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/x-dv&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;dv&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-dvi&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;dvi&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.ms-fontobject&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;eot&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/x-setext&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;etx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/gif&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;gif&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-gtar&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;gtar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-gzip&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;gz&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-hdf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;hdf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/mac-binhex40&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;hqx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/x-component&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;htc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/ief&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ief&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/vnd.sun.j2me.app-descriptor&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;jad&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/java-archive&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;jar&#39;</span><span class=p>,</span> <span class=s1>&#39;war&#39;</span><span class=p>,</span> <span class=s1>&#39;ear&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/x-java-source&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;java&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-java-jnlp-file&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;jnlp&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/jpeg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;jpg&#39;</span><span class=p>,</span> <span class=s1>&#39;jpeg&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/javascript&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;js&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/plain&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;txt&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/json&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;json&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/midi&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;midi&#39;</span><span class=p>,</span> <span class=s1>&#39;mid&#39;</span><span class=p>,</span> <span class=s1>&#39;kar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-latex&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;latex&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/x-mpegurl&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;m3u&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-macpaint&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pnt&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/troff&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;tr&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/mathml+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mathml&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-mif&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mif&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/quicktime&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;qt&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/x-sgi-movie&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;movie&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/mpeg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mpa&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/mp4&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mp4&#39;</span><span class=p>,</span> <span class=s1>&#39;m4v&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/mpeg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mpg&#39;</span><span class=p>,</span> <span class=s1>&#39;mpeg&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/mpeg2&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;mpv2&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-wais-source&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;src&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-netcdf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;nc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/oda&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;oda&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.database&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odb&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.chart&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.formula&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.graphics&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odg&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.image&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odi&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.text-master&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.presentation&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odp&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.spreadsheet&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ods&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.text&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;odt&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.graphics-template&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;otg&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.text-web&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;oth&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.presentation-template&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;otp&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.spreadsheet-template&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ots&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.oasis.opendocument.text-template&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ott&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/ogg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ogx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/ogg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ogv&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/ogg&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;spx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-font-opentype&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;otf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/flac&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;flac&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/annodex&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;anx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/annodex&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;axa&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/annodex&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;axv&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/xspf+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xspf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-portable-bitmap&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pbm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/pict&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pict&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/pdf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pdf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-portable-graymap&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pgm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/x-scpls&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pls&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/png&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;png&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-portable-anymap&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pnm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-portable-pixmap&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ppm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.ms-powerpoint&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;pps&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/vnd.adobe.photoshop&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;psd&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-quicktime&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;qtif&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-cmu-raster&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ras&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/rdf+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;rdf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-rgb&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;rgb&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.rn-realmedia&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;rm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/rtf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;rtf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/richtext&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;rtx&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/font-sfnt&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;sfnt&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-sh&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-shar&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;shar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-stuffit&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;sit&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-sv4cpio&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;sv4cpio&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-sv4crc&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;sv4crc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/svg+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;svgz&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-shockwave-flash&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;swf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-tar&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;tar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-tcl&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;tcl&#39;</span><span class=p>,</span> <span class=s1>&#39;tk&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-tex&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;tex&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-texinfo&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;texinfo&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/tiff&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;tiff&#39;</span><span class=p>,</span> <span class=s1>&#39;tif&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/tab-separated-values&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;tsv&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-font-ttf&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ttf&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-ustar&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ustar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/voicexml+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;vxml&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-xbitmap&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xbm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/xhtml+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xhtml&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.ms-excel&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xls&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xsl&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-xpixmap&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xpm&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/xslt+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xslt&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.mozilla.xul+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xul&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/x-xwindowdump&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;xwd&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.visio&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;vsd&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;audio/x-wav&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wav&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;image/vnd.wap.wbmp&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wbmp&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/vnd.wap.wml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wml&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.wap.wmlc&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wmlc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;text/vnd.wap.wmlsc&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wmls&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/vnd.wap.wmlscriptc&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wmlscriptc&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;video/x-ms-wmv&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wmv&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/font-woff&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;woff&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/font-woff2&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;woff2&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;model/vrml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wrl&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/wspolicy+xml&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;wspolicy&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/x-compress&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;z&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;application/zip&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;zip&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>fileMimeType</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>k</span> <span class=k>in</span> <span class=nx>FileMimeType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>FileMimeType</span><span class=p>[</span><span class=nx>k</span><span class=p>].</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>ext</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fileMimeType</span><span class=p>[</span><span class=nx>ext</span><span class=p>]</span> <span class=o>=</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// é¢„å…ˆéªŒè¯çš„è¯·æ±‚ URL
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>OOS_BUCKET_PREAUTH_URL</span> <span class=o>=</span> <span class=s1>&#39;&lt;ä½ åˆ›å»ºçš„é¢„å…ˆéªŒè¯çš„è¯·æ±‚ URL&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>preAuthURL</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>OOS_BUCKET_PREAUTH_URL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span> <span class=nx>env</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>host</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>host</span>
</span></span><span class=line><span class=cl>    <span class=nx>url</span><span class=p>.</span><span class=nx>host</span> <span class=o>=</span> <span class=nx>preAuthURL</span><span class=p>.</span><span class=nx>host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span> <span class=o>=</span> <span class=nx>preAuthURL</span><span class=p>.</span><span class=nx>pathname</span> <span class=o>+</span> <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>newRequest</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Request</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>newRequest</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s1>&#39;X-Forwarded-Host&#39;</span><span class=p>,</span> <span class=nx>host</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>newRequest</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>!=</span> <span class=mi>200</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>response</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>contentType</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>contentType</span> <span class=o>&amp;&amp;</span> <span class=nx>contentType</span> <span class=o>!=</span> <span class=s1>&#39;application/octet-stream&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>response</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>newResponse</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=nx>response</span><span class=p>.</span><span class=nx>headers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>status</span><span class=o>:</span> <span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>statusText</span><span class=o>:</span> <span class=nx>response</span><span class=p>.</span><span class=nx>statusText</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>ext</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>).</span><span class=nx>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>contentType</span> <span class=o>=</span> <span class=nx>fileMimeType</span><span class=p>[</span><span class=nx>ext</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>contentType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>newResponse</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>,</span> <span class=nx>contentType</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>newResponse</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å°†äºŒçº§åŸŸåæŒ‡å‘-worker>å°†äºŒçº§åŸŸåæŒ‡å‘ Worker</h3><p>è¿›å…¥åˆ°åˆ›å»ºçš„ Worker ç®¡ç†é¡µé¢ï¼ŒSettings -> Add routeã€‚
<img src=https://oos.ogr.xyz/7a97b2030fda600be4d16074a3c043e90c280a3cf77329fc4565e72c56cfd810.png loading=lazy alt="picture 7"><br>Route å¡« <code>oos.ogr.xyz/*</code>ï¼ŒZone é€‰ <code>ogr.xyz</code>ã€‚è¿™æ ·å°±æŠŠ <code>oos.ogr.xyz</code> çš„æ‰€æœ‰è¯·æ±‚è·¯ç”±åˆ°å½“å‰ Workerã€‚</p><h3 id=å¼€å¯ç¼“å­˜>å¼€å¯ç¼“å­˜</h3><p>è¿›å…¥åˆ°è§„åˆ™ç®¡ç†é¡µé¢ï¼ŒHome -> Websites -> ogr.xyz -> Rules -> Page Rulesã€‚</p><p>ç‚¹å‡» Create Page Ruleã€‚<br><img src=https://oos.ogr.xyz/5f84565929ce6826c74e818302ad93ed2354a2e3ccdd19ca73553eb87d17653b.png loading=lazy alt="picture 8"><br>URL å¡« <code>oos.ogr.xyz/*</code>, Pick a Setting é€‰ <code>Cache Level</code>ï¼ŒSelect Cache Level é€‰ <code>Cache Everything</code>ã€‚è¿™æ ·æ‰€æœ‰ <code>oos.ogr.xyz</code> è¯·æ±‚çš„å“åº”éƒ½ä¼šè¢«ç¼“å­˜ï¼Œå°±è¾¾åˆ° CDN çš„æ•ˆæœäº†ã€‚</p><h2 id=ä½¿ç”¨æ–¹æ³•>ä½¿ç”¨æ–¹æ³•</h2><p>è‡³æ­¤ï¼Œæ‰€æœ‰çš„å‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ï¼Œå¯¹äºä¸Šä¼ è‡³å­˜å‚¨æ¡¶çš„æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ <code>https://oos.ogr.xyz/&lt;key></code> è®¿é—®åˆ°äº†ã€‚</p><p>å¯¹äºä½¿ç”¨ VS Code å†™ Markdown çš„ç”¨æˆ·ï¼Œæ¨è <code>Markdown Image</code> æ’ä»¶ã€‚è¯¥æ’ä»¶ä»¥ç²˜è´´çš„å½¢å¼è‡ªåŠ¨ä¸Šä¼ è‡³äº‘æœåŠ¡å¹¶ç”Ÿæˆå¯è®¿é—®é“¾æ¥ã€‚è¯¦æƒ…å¯å‚è§<a class=link href=https://github.com/imlinhanchao/vsc-markdown-image target=_blank rel=noopener>æ’ä»¶è¯´æ˜</a>ã€‚</p><p>Markdown Image æ’ä»¶å®é™…ä½¿ç”¨é…ç½®å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.base.uploadMethod&#34;</span><span class=err>:</span> <span class=s2>&#34;S3&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.endpoint&#34;</span><span class=err>:</span> <span class=s2>&#34;https://compat.objectstorage.ap-tokyo-1.oraclecloud.com/bucket-oracle-free-20G&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.region&#34;</span><span class=err>:</span> <span class=s2>&#34;ap-tokyo-1&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.bucketName&#34;</span><span class=err>:</span> <span class=s2>&#34;&lt;åç§°ç©ºé—´&gt;&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.accessKeyId&#34;</span><span class=err>:</span> <span class=s2>&#34;&lt;Key ID&gt;&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.secretAccessKey&#34;</span><span class=err>:</span> <span class=s2>&#34;&lt;Secret key&gt;&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.cdn&#34;</span><span class=err>:</span> <span class=s2>&#34;https://oos.ogr.xyz/${filepath}&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;markdown-image.s3.config&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;forcePathStyle&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€»ç»“>æ€»ç»“</h2><p>å¯¹è±¡å­˜å‚¨ä¸€èˆ¬è¦æ­é… CDN ä¸€èµ·ä½¿ç”¨ã€‚ä¸ºäº†å…è´¹ä½¿ç”¨ Cloudflare CDNï¼Œä¸Šè¿°æ­¥éª¤ç•¥æ˜¾å¤æ‚ã€‚<br>å…¶å®å¦‚æœå·²ç»åœ¨ä½¿ç”¨ Cloudflare Pages æ‰˜ç®¡åšå®¢äº†ï¼Œé‚£ä¸å¦¨ç›´æ¥ä½¿ç”¨ Cloudflare R2 å¯¹è±¡å­˜å‚¨ï¼šæœ‰ 10G çš„å…è´¹å­˜å‚¨é¢åº¦ï¼Œé…ç½®ç®€å•ï¼Œè‡ªå¸¦ CDN æ”¯æŒï¼Œä¸ªäººåšå®¢ç”¨æˆ·åŸºæœ¬å¤Ÿç”¨ã€‚</p></section><footer class=article-footer><section class=article-tags><a href=/tags/oci/>OCI</a>
<a href=/tags/object-storage/>Object Storage</a>
<a href=/tags/cloudflare/>Cloudflare</a>
<a href=/tags/cdn/>CDN</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/garage-setup/><div class=article-details><h2 class=article-title>Garageå¯¹è±¡å­˜å‚¨çš„å®‰è£…å’Œä½¿ç”¨</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=hzj629206/blog data-repo-id=R_kgDOLddzNw data-category=General data-category-id=DIC_kwDOLddzN84Cd0UC data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2024 ogr.xyz</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.23.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>